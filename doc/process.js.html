<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: process.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: process.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>var ImPro;

(function (that) {
  /**
   * Abstract process param constructor. Should not be called but from a child constructor with 'super' function.
   * @class
   * @param {string} name - Name of the parameter
   * @param {*} defaultValue - Default value of the parameter
   */
  function AbstractProcessParam(name, defaultValue) {
    /**
     * Name of the parameter
     * @type {string}
     */
    this.name = name;
    /**
     * Default value of the parameter
     * @type {*}
     */
    this.defaultValue = defaultValue;
  }

  /**
   * Boolean process param constructor.
   * @class
   * @param {string} name - Name of the parameter
   * @param {boolean} [defaultValue = false] - Default value of the parameter
   */
  that.BooleanProcessParam = that.extends(AbstractProcessParam,
  function(name, defaultValue) {
    defaultValue = !!defaultValue;
    that.super(this, [name, defaultValue]);
  });

  /**
   * Number process param constructor.
   * @class
   * @param {string} name - Name of the parameter
   * @param {Object.&lt;string, *>} [options = {}] - Additional options: step (1), min (none), max (none)
   * @param {number} [defaultValue = 0] - Default value of the parameter
   */
  that.NumberProcessParam = that.extends(AbstractProcessParam,
  function(name, options, defaultValue) {
    defaultValue = (typeof defaultValue === 'number') ? defaultValue : 0;
    that.super(this, [name, defaultValue]);
  });

  /**
   * Select process param constructor.
   * @class
   * @param {string} name - Name of the parameter
   * @param {Object.&lt;string, *>} values - List of selectable values, with the key as label
   * @param {string|null} [defaultValue = null] - Key of the value selected by default; none if null
   */
  that.SelectProcessParam = that.extends(AbstractProcessParam,
  function(name, values, defaultValue) {
    defaultValue = (defaultValue in values) ? defaultValue : null;
    that.super(this, [name, defaultValue]);
  });

  // TODO: ProcessInput &amp; ProcessOutput classes

  /**
   * Process constructor.
   * @class
   * @param {string} name - Name of the process
   * @param {Object.&lt;string, AbstractProcessParam>} paramConfigs - List of process params
   * @param {Object.&lt;string, *>} inputConfigs - List of process inputs
   * @param {Object.&lt;string, *>} outputConfigs - List of process outputs
   * @param {function(Object.&lt;string, *>, Object.&lt;string, *>)} run - Function to execute
   */
  that.Process = function(name, paramConfigs, inputConfigs, outputConfigs, run) {
    /**
     * Name of the process
     * @type {string}
     */
    this.name = name;
    /**
     * List of process params
     * @type {Object.&lt;string, AbstractProcessParam>}
     */
    this.paramConfigs = paramConfigs;
    /**
     * List of process inputs
     * @type {Object.&lt;string, *>}
     */
    this.inputConfigs = inputConfigs;
    /**
     * List of process outputs
     * @type {Object.&lt;string, *>}
     */
    this.outputConfigs = outputConfigs;
    /**
     * Function to execute
     * @type {function(Object.&lt;string, *>, Object.&lt;string, *>)}
     */
    this.run = function(inputs, params) {
      // Check inputs
      for (var i in inputConfigs) {
        if (!(i in inputs)) {
          throw new Error('Missing input "' + i + '". Abort.');
        }
        var input = inputs[i], inputConfig = inputConfigs[i], inputSupportedType = false;
        for (var it in inputConfig.types) {
          inputSupportedType = inputSupportedType || (input instanceof inputConfig.types[it]);
        }
        if (!inputSupportedType) {
          throw new Error('Invalid type for input "' + i + '". Abort.');
        }
      }

      // TODO: Check params

      // Run
      var outputs = run(inputs, params);

      // Check outputs
      for (var o in outputConfigs) {
        if (!(o in outputs)) {
          throw new Error('Missing output "' + o + '". Abort.');
        }
        var output = outputs[o], outputConfig = outputConfigs[o], outputSupportedType = false;
        for (var ot in outputConfig.types) {
          outputSupportedType = outputSupportedType || (output instanceof outputConfig.types[ot]);
        }
        if (!outputSupportedType) {
          throw new Error('Invalid type for output "' + o + '". Abort.');
        }
      }

      return outputs;
    };
  };

  that.testProcess = new that.Process('Test process', {},
    {'Image': {types: [that.Uint8ClampedGrayImage]}},
    {'Image': {types: [that.Uint8ClampedGrayImage]}},
    function(inputs) {
      var inputImage = inputs.Image;

      var outputImage = new that.Uint8ClampedGrayImage(inputImage.width, inputImage.height);

      for (var t = 0, tt = inputImage.length; t &lt; tt; ++t) {
        outputImage.data[t] = 0xff - inputImage.data[t];
      }

      return {'Image': outputImage};
    }
  );
})(ImPro);
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="that.BooleanProcessParam.html">BooleanProcessParam</a></li><li><a href="that.NumberProcessParam.html">NumberProcessParam</a></li><li><a href="that.Process.html">Process</a></li><li><a href="that.SelectProcessParam.html">SelectProcessParam</a></li><li><a href="%257BDataType%257D%257BChannelProfile%257DImage.html">{DataType}{ChannelProfile}Image</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Wed Mar 21 2018 00:54:38 GMT+0100 (CET)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
