/*! impro.js 26-03-2018 */

"use strict";var ImPro=new function(){};!function(t){t.extends=function(a,t){return t.prototype=function(t,n){function e(){this.constructor=n.prototype.constructor}return e.prototype=a.prototype,new e}(0,t),t.prototype.ParentClass=a,t},t.super=function(t,n){t.ParentClass.apply(t,n)}}(ImPro),function(s){function t(t,n,e,a,i){var r=window[t+"Array"],o=s.channelProfiles[n];this.dataType=t,this.arrayType=r,this.channelProfile=n,this.channelCount=o,this.width=e,this.height=a,this.dx=o,this.dy=e*o,this.length=e*a*o,this.data=new r(this.length),(i instanceof r||i instanceof Array)&&this.data.set(i)}function n(a,i){s[a+i+"Image"]=s.extends(t,function(t,n,e){s.super(this,[a,i,t,n,e])})}for(var e in s.dataTypes=["Uint8Clamped","Uint8","Uint16","Uint32","Int8","Int16","Int32","Float32","Float64"],s.channelProfiles={Gray:1,Rgb:3,Rgba:4},s.dataTypes){var a=s.dataTypes[e];for(var i in s.channelProfiles)n(a,i)}s.Uint8ClampedRgbaImage.fromCanvas=function(t){var n=t.getContext("2d").getImageData(0,0,t.width,t.height);return new s.Uint8ClampedRgbaImage(t.width,t.height,n.data)},s.Uint8ClampedRgbaImage.fromDomImage=function(t){var n=document.createElement("canvas");return n.width=t.width,n.height=t.height,n.getContext("2d").drawImage(t,0,0),s.Uint8ClampedRgbaImage.fromCanvas(n)},s.Uint8ClampedRgbaImage.fromLocalFile=function(t,n){var e=new window.Image;e.addEventListener("load",function(){var t=s.Uint8ClampedRgbaImage.fromDomImage(e);n(t)},!1),e.src=t},s.Uint8ClampedRgbaImage.prototype.toCanvas=function(t){void 0===t&&((t=document.createElement("canvas")).width=this.width,t.height=this.height);var n=t.getContext("2d"),e=n.createImageData(t.width,t.height);return e.data.set(this.data),n.putImageData(e,0,0),t},s.Uint8ClampedRgbaImage.prototype.toDataURL=function(){var t=document.createElement("canvas");return t.width=this.width,t.height=this.height,this.toCanvas(t),t.toDataURL("image/png")},s.Uint8ClampedRgbaImage.prototype.toDomImage=function(t){return void 0===t&&(t=new window.Image),t.src=this.toDataURL(),t}}(ImPro),function(a){function t(t,n,e){this.name=n,this.defaultValue=e,this.valueType=t}a.BooleanProcessParam=a.extends(t,function(t,n){n=!!n,a.super(this,["boolean",t,n])}),a.NumberProcessParam=a.extends(t,function(t,n,e){e="number"==typeof e?e:0,a.super(this,["number",t,e])}),a.SelectProcessParam=a.extends(t,function(t,n,e){e=e in n?e:null,a.super(this,["string",t,e])}),a.Process=function(t,d,g,l,w){this.name=t,this.paramConfigs=d,this.inputConfigs=g,this.outputConfigs=l,this.run=function(t,n){for(var e in g){if(!(e in t))throw new Error('Missing input "'+e+'". Abort.');var a=t[e],i=g[e],r=!1;for(var o in i)r=r||a instanceof i[o];if(!r)throw new Error('Invalid type for input "'+e+'". Abort.')}for(var s in d){if(!(s in n))throw new Error('Missing param "'+s+'". Abort.');if(!(typeof n[s]===d[s].valueType))throw new Error('Invalid type for param "'+s+'". Abort.')}var h=w(t,n);for(var u in l){if(!(u in h))throw new Error('Missing output "'+u+'". Abort.');var f=h[u],m=l[u],c=!1;for(var p in m)c=c||f instanceof m[p];if(!c)throw new Error('Invalid type for output "'+u+'". Abort.')}return h}}}(ImPro);