/*! impro.js 28-03-2018 */

"use strict";var ImPro=new function(){};!function(t){t.extends=function(a,t){return t.prototype=function(t,n){function e(){this.constructor=n.prototype.constructor}return e.prototype=a.prototype,new e}(0,t),t.prototype.ParentClass=a,t},t.super=function(t,n){t.ParentClass.apply(t,n)}}(ImPro),function(s){function t(t,n,e,a,i){var o=window[t+"Array"],r=s.channelProfiles[n];this.dataType=t,this.arrayType=o,this.channelProfile=n,this.channelCount=r,this.width=e,this.height=a,this.dx=r,this.dy=e*r,this.length=e*a*r,this.data=new o(this.length),(i instanceof o||i instanceof Array)&&this.data.set(i)}function n(a,i){s[a+i+"Image"]=s.extends(t,function(t,n,e){s.super(this,[a,i,t,n,e])})}for(var e in s.dataTypes=["Uint8Clamped","Uint8","Uint16","Uint32","Int8","Int16","Int32","Float32","Float64"],s.channelProfiles={Gray:1,Rgb:3,Rgba:4},s.dataTypes){var a=s.dataTypes[e];for(var i in s.channelProfiles)n(a,i)}s.Uint8ClampedRgbaImage.fromCanvas=function(t){var n=t.getContext("2d").getImageData(0,0,t.width,t.height);return new s.Uint8ClampedRgbaImage(t.width,t.height,n.data)},s.Uint8ClampedRgbaImage.fromDomImage=function(t){var n=document.createElement("canvas");return n.width=t.width,n.height=t.height,n.getContext("2d").drawImage(t,0,0),s.Uint8ClampedRgbaImage.fromCanvas(n)},s.Uint8ClampedRgbaImage.fromLocalFile=function(t,n){var e=new window.Image;e.addEventListener("load",function(){var t=s.Uint8ClampedRgbaImage.fromDomImage(e);n(t)},!1),e.src=t},s.Uint8ClampedRgbaImage.prototype.toCanvas=function(t){void 0===t&&((t=document.createElement("canvas")).width=this.width,t.height=this.height);var n=t.getContext("2d"),e=n.createImageData(t.width,t.height);return e.data.set(this.data),n.putImageData(e,0,0),t},s.Uint8ClampedRgbaImage.prototype.toDataURL=function(){var t=document.createElement("canvas");return t.width=this.width,t.height=this.height,this.toCanvas(t),t.toDataURL("image/png")},s.Uint8ClampedRgbaImage.prototype.toDomImage=function(t){return void 0===t&&(t=new window.Image),t.src=this.toDataURL(),t}}(ImPro),ImPro.Process=function(t,u,l,v){this.name=t,this.lastExecutionTime=null;for(var n=0,e=u.length;n<e;++n){var a=u[n];void 0===a.connectable&&(a.connectable=!0),void 0===a.configurable&&(a.configurable=!1),void 0===a.configOptions&&(a.configOptions={})}this.inputConfigs=u,this.outputConfigs=l,this.run=function(t){for(var n=[],e=0,a=u.length;e<a;++e){var i=u[e];if(void 0===t[e])throw new Error('Missing input "'+i.name+'". Abort.');for(var o=t[e],r=!1,s=0,h=i.types.length;s<h;++s)o instanceof i.types[s]&&(r=!0,n[e]=i.types[s]);if(!r)throw new Error('Invalid type for input "'+i.name+'". Abort.')}var g=performance.now(),c=v(n,t),m=performance.now();this.lastExecutionTime=m-g;for(var d=0,p=l.length;d<p;++d){var f=l[d];if(void 0===c[d])throw new Error('Missing output "'+f.name+'". Abort.');if(!(c[d]instanceof f.type(n,t)))throw new Error('Invalid type for output "'+f.name+'". Abort.')}return c}};